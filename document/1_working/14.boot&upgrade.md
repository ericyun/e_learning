## boot & upgrade

###  修订记录
| 修订说明 | 日期 | 作者 | 额外说明 |
| --- |
| 初版 | 2018/05/30 | 员清观 |  |

## 0 待增内容：
  gendisk/mkburn流程
  烧录流程

## 1

### .1 part分区定义

**QSDK/product/PRODUCT_NAME/items.itm**<br>
```cpp
//这里没有定义normal分区(只用作只读文件系统)
part0                     uboot.48.boot
part1                     item.16.boot
part2                     ramdisk.4096.boot
part3                     kernel.4096.boot
part5                     system.19968.fs
part6                     config.512.fs
```
**QSDK/product/PRODUCT_NAME/burn.ixl文件配置**<br>
```cpp
//与上面part一一对应
i run   0x08000200  0x08000000   ../../output/images/uboot0.isi
r flash 0x0                      ../../output/images/uboot0.isi
r flash 0x1                      ../../output/images/items.itm
r flash 0x2                      ../../output/images/ramdisk.img
r flash 0x3                      ../../output/images/uImage
r flash 0x5                      ../../output/images/rootfs.squashfs
```

**boot设备选择：**<br>
make menuconfig
  `选择BootLoader > U-Boot > Boot Device > SPI Flash配置`
items.itm文件中
  `board.disk    flash`

**uboot0启动对part和kernel参数的管理**<br>

Kernel command line: console=ttyAMA3,115200 lpj=567808 mem=62M mode=ius //烧录

Kernel command line: console=ttyAMA3,115200 lpj=567808 mem=62M rootfstype=ext4 root=/dev/mmcblk0p2 rw init=/init

```cpp
part0					uboot.48.boot
part1					item.16.boot
part3					kernel.2560.boot
part5					system.8000.normal
part7					config.512.fs.fat

Kernel command line: console=ttyAMA3,115200 lpj=567808 mem=62M rootfstype=squashfs root=/dev/spiblock1 rw
[    1.063333] infotm spi initilize completely dev size: 337 240
[    1.066666] spi add disk dev boot 0 2a0000    //spiblock0 物理分区，实际无法mount
[    1.073333] spi add disk dev normal 2a0000 7d0000 //spiblock1 rootfs，normal分区　启动之后已经mount，/dev/root
[    1.079999] spi add disk dev config a70000 80000 left size: 20887K　// fs分区，基于ftl
```

/dev/root

## 2

## 3

## 4

## 5
### 5.1

## 6
